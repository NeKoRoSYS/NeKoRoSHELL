#!/bin/bash

if pgrep -x hyprshot > /dev/null || pgrep -x slurp > /dev/null; then
    killall -9 hyprshot slurp hyprpicker grim || true
    exit 0
fi

MODE="${1:-}"

if [ "$MODE" == "region" ]; then
    hyprshot -m region --clipboard-only --freeze -s
else
    hyprshot -m $MODE --clipboard-only -s
fi

pkill rofi || true

rm -f /tmp/screenshot_*.png
IMG_PATH="/tmp/screenshot_$(date +%s).png"

if wl-paste > "$IMG_PATH"; then
    sleep 0.5
    makenotif hyprshot "$IMG_PATH" Hyprshot "Captured $MODE to clipboard!" true camera-shutter.oga
fi
